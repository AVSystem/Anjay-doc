

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>4.5.4. Multi-instance writable object with fixed number of instances &mdash; Anjay 1.15.5 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="4.5.5. Multi-instance writable object with dynamic number of instances" href="BT_CO5_MultiInstanceDynamic.html" />
    <link rel="prev" title="4.5.3. Multi-instance read-only object with fixed number of instances" href="BT_CO3_MultiInstanceReadOnlyFixed.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Anjay
          

          
          </a>

          
            
            
              <div class="version">
                1.15.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../Introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../LwM2M.html">2. OMA LwM2M - Brief description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Compiling_client_applications.html">3. Compiling client applications</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../BasicTutorial.html">4. Basic tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../BT1.html">4.1. Getting started!</a></li>
<li class="toctree-l2"><a class="reference internal" href="../BT2.html">4.2. Installing mandatory Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../BT3.html">4.3. Event loop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../BT4.html">4.4. A few notes on general usage</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../BT5_CustomObject.html">4.5. Custom LwM2M objects</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="BT_CO1_SingleInstanceReadOnly.html">4.5.1. Single-instance read-only object</a></li>
<li class="toctree-l3"><a class="reference internal" href="BT_CO2_SingleInstanceExecutableAndReadOnly.html">4.5.2. Single-instance read-only object with an executable resource</a></li>
<li class="toctree-l3"><a class="reference internal" href="BT_CO3_MultiInstanceReadOnlyFixed.html">4.5.3. Multi-instance read-only object with fixed number of instances</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">4.5.4. Multi-instance writable object with fixed number of instances</a></li>
<li class="toctree-l3"><a class="reference internal" href="BT_CO5_MultiInstanceDynamic.html">4.5.5. Multi-instance writable object with dynamic number of instances</a></li>
<li class="toctree-l3"><a class="reference internal" href="BT_CO6_MultipleResourceInstances.html">4.5.6. Objects with Multiple Instance Resources</a></li>
<li class="toctree-l3"><a class="reference internal" href="BT_CO7_BootstrapAwareness.html">4.5.7. Bootstrap awareness</a></li>
<li class="toctree-l3"><a class="reference internal" href="BT_CO8_Notifications.html">4.5.8. Notifications for dynamically-changing Resources</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../AdvancedTutorial.html">5. Advanced tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Tools.html">6. Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PortingGuideForNonPOSIXPlatforms.html">7. Porting guide for non-POSIX platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Commercial_support.html">8. Commercial support</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Anjay</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../BasicTutorial.html">4. Basic tutorial</a> &raquo;</li>
        
          <li><a href="../BT5_CustomObject.html">4.5. Custom LwM2M objects</a> &raquo;</li>
        
      <li>4.5.4. Multi-instance writable object with fixed number of instances</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/BasicTutorial/BT5_CustomObject/BT_CO4_FixedInstanceWritable.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="multi-instance-writable-object-with-fixed-number-of-instances">
<h1>4.5.4. Multi-instance writable object with fixed number of instances<a class="headerlink" href="#multi-instance-writable-object-with-fixed-number-of-instances" title="Permalink to this headline">¶</a></h1>
<p>In this tutorial you will learn:</p>
<ul class="simple">
<li><p>how to implement <code class="docutils literal notranslate"><span class="pre">resource_write</span></code> to create a writeable Resource,</p></li>
<li><p>what are Partial Update and Replace variants of the LwM2M Write request,</p></li>
<li><p>how to setup <code class="docutils literal notranslate"><span class="pre">instance_reset</span></code> handler to handle LwM2M Write (Replace),</p></li>
<li><p>basics of transaction handling in Anjay.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This section explains manual implementation of custom objects. If the
object you wish to implement is a standard one, registered in <a class="reference external" href="http://www.openmobilealliance.org/wp/OMNA/LwM2M/LwM2MRegistry.html">OMA LwM2M
Object and Resource Registry</a>,
you can generate Anjay object stub from the Object Definition XML with
<a class="reference internal" href="../../Tools.html#anjay-object-stub-generator"><span class="std std-ref">Anjay Object stub generator</span></a>.</p>
<p>We still encourage you to read the tutorial to have a clear understanding
on what various parts of the LwM2M object code are for.</p>
</div>
<p>Implemented object is based on <a class="reference internal" href="BT_CO3_MultiInstanceReadOnlyFixed.html"><span class="doc">Multi-instance read-only object with fixed number of instances</span></a>,
but this time accepts Write requests.</p>
<table class="docutils align-center">
<colgroup>
<col style="width: 37%" />
<col style="width: 31%" />
<col style="width: 31%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Object ID</p></th>
<th class="head"><p>Instances</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Test object</p></td>
<td><p>1234</p></td>
<td><p>Multiple</p></td>
</tr>
</tbody>
</table>
<p>Each Object Instance has two Resources:</p>
<table class="docutils align-center">
<colgroup>
<col style="width: 11%" />
<col style="width: 21%" />
<col style="width: 19%" />
<col style="width: 17%" />
<col style="width: 17%" />
<col style="width: 14%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Resource ID</p></th>
<th class="head"><p>Operations</p></th>
<th class="head"><p>Instances</p></th>
<th class="head"><p>Mandatory</p></th>
<th class="head"><p>Type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Label</p></td>
<td><p>0</p></td>
<td><p>Read/Write</p></td>
<td><p>Single</p></td>
<td><p>Mandatory</p></td>
<td><p>String</p></td>
</tr>
<tr class="row-odd"><td><p>Value</p></td>
<td><p>1</p></td>
<td><p>Read/Write</p></td>
<td><p>Single</p></td>
<td><p>Mandatory</p></td>
<td><p>Integer</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The code is based on <a class="reference internal" href="BT_CO3_MultiInstanceReadOnlyFixed.html"><span class="doc">Multi-instance read-only object with fixed number of instances</span></a>.</p>
</div>
<div class="section" id="simple-variant">
<h2>4.5.4.1. Simple variant<a class="headerlink" href="#simple-variant" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">test_instance_t</span></code> needs to be able to store arbitrary data. Let us set
an arbitrary limit of 32 characters in length (including terminating nullbyte):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">typedef</span> <span class="n">struct</span> <span class="n">test_instance</span> <span class="p">{</span>
    <span class="n">char</span> <span class="n">label</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
    <span class="n">int32_t</span> <span class="n">value</span><span class="p">;</span>
<span class="p">}</span> <span class="n">test_instance_t</span><span class="p">;</span>
</pre></div>
</div>
<p>Now the <code class="docutils literal notranslate"><span class="pre">anjay_dm_resource_write_t</span></code> handler implementation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>static int test_resource_write(anjay_t *anjay,
                               const anjay_dm_object_def_t *const *obj_ptr,
                               anjay_iid_t iid,
                               anjay_rid_t rid,
                               anjay_input_ctx_t *ctx) {
    (void) anjay; // unused

    test_object_t *test = get_test_object(obj_ptr);

    // IID validity was checked by the `anjay_dm_instance_present_t` handler.
    // If the Object Instance set does not change, or can only be modifed
    // via LwM2M Create/Delete requests, it is safe to assume IID is correct.
    assert((size_t) iid &lt; NUM_INSTANCES);
    struct test_instance *current_instance = &amp;test-&gt;instances[iid];

    switch (rid) {
    case 0: {
        // `anjay_get_string` may return a chunk of data instead of the
        // whole value - we need to make sure the client is able to hold
        // the entire value
        char buffer[sizeof(current_instance-&gt;label)];
        int result = anjay_get_string(ctx, buffer, sizeof(buffer));

        if (result == 0) {
            // value OK - save it
            memcpy(current_instance-&gt;label, buffer, sizeof(buffer));
        } else if (result == ANJAY_BUFFER_TOO_SHORT) {
            // the value is too long to store in the buffer
            result = ANJAY_ERR_BAD_REQUEST;
        }

        return result;
    }

    case 1:
        // reading primitive values can be done directly - the value will only
        // be written to the output variable if everything went fine
        return anjay_get_i32(ctx, &amp;current_instance-&gt;value);

    default:
        // control will never reach this part due to object&#39;s supported_rids
        return ANJAY_ERR_INTERNAL;
    }
}
</pre></div>
</div>
<p>Everything that was left to do is plugging in handlers. There is a catch though:
any modifying operation (writing a value, creating or deleting an Object
Instance) requires explicitly defined transaction handlers.
<code class="docutils literal notranslate"><span class="pre">anjay_transaction_handler_NOOP</span></code> placeholder will be used for now, see
<a class="reference internal" href="#fixedinstancewritable-transactional"><span class="std std-ref">Transactional variant</span></a> for an actual implementation of
these.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">static</span> <span class="n">const</span> <span class="n">anjay_dm_object_def_t</span> <span class="n">OBJECT_DEF</span> <span class="o">=</span> <span class="p">{</span>
     <span class="o">//</span> <span class="o">...</span>
     <span class="o">.</span><span class="n">handlers</span> <span class="o">=</span> <span class="p">{</span>
         <span class="o">//</span> <span class="o">...</span>

         <span class="o">.</span><span class="n">resource_write</span> <span class="o">=</span> <span class="n">test_resource_write</span><span class="p">,</span>

         <span class="o">.</span><span class="n">transaction_begin</span> <span class="o">=</span> <span class="n">anjay_dm_transaction_NOOP</span><span class="p">,</span>
         <span class="o">.</span><span class="n">transaction_validate</span> <span class="o">=</span> <span class="n">anjay_dm_transaction_NOOP</span><span class="p">,</span>
         <span class="o">.</span><span class="n">transaction_commit</span> <span class="o">=</span> <span class="n">anjay_dm_transaction_NOOP</span><span class="p">,</span>
         <span class="o">.</span><span class="n">transaction_rollback</span> <span class="o">=</span> <span class="n">anjay_dm_transaction_NOOP</span>
     <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Complete code of this example can be found in
<cite>examples/tutorial/custom-object/writable-multiple-fixed</cite> subdirectory of
main Anjay project repository.</p>
</div>
<div class="section" id="lwm2m-write-operation-modes">
<h3>4.5.4.1.1. LwM2M Write operation modes<a class="headerlink" href="#lwm2m-write-operation-modes" title="Permalink to this headline">¶</a></h3>
<p>An LwM2M server may perform a Write on the <em>entire Object Instance</em>. Two
variants of such requests are available - both replace values of Instance
Resources with received values, but they differ in what happens to Resources
not present in the request:</p>
<ul>
<li><p>Partial Update - they are leaved unchanged,</p></li>
<li><p>Replace - Optional Resources are reset to “missing” state. All mandatory
Resources MUST be specified in the request, otherwise it MUST be considered
invalid.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Anjay does not distinguish Mandatory and Optional Resources - the user
is responsible for ensuring the state of an Object is still valid after
handling a request. This topic is covered in detail in
<a class="reference internal" href="#fixedinstancewritable-transactional"><span class="std std-ref">Transactional variant</span></a>; we will ignore it in this
particular example.</p>
</div>
</li>
</ul>
<p>Anjay implements Partial Update as a series of <code class="docutils literal notranslate"><span class="pre">resource_write</span></code> calls and
Replace one as <code class="docutils literal notranslate"><span class="pre">instance_reset</span></code> + series of <code class="docutils literal notranslate"><span class="pre">resource_write</span></code> calls.
To properly support both Write variants, <code class="docutils literal notranslate"><span class="pre">instance_reset</span></code> needs to be
implemented too.</p>
</div>
<div class="section" id="anjay-transaction-handlers">
<h3>4.5.4.1.2. Anjay transaction handlers<a class="headerlink" href="#anjay-transaction-handlers" title="Permalink to this headline">¶</a></h3>
<p>In some cases, like LwM2M Write requests targeting an Object Instance, Anjay
calls multiple handlers modifying the data model to perform a single atomic
operation. In such case, transactions ensure that data model is not left
in an inconsistent state when one of handler calls fails. To achieve correct
behavior, used-defined handlers should behave as described below:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">anjay_dm_resource_write_t</span></code> - needs to ensure that the value being written
is correct and store new value in such a way that rolling back to the previous
one is still possible. It must not check constraints that depend on values
of other Resources, as these Resources may also change during the same
transaction.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">anjay_dm_transaction_begin_t</span></code> - always called before any operation that
changes the data model (LwM2M Write, Create, Delete). It should do whatever
actions are necessary for correct transaction handling - in the simplest
possible case, it could save a snapshot of the current state of the Object
to restore it when rollback is required.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">anjay_dm_transaction_validate_t</span></code> - called after all write/create/remove
handlers succeed. It should verify cross-Resource or cross-Instance
constraints and fail if the data model state is not consistent.
<strong>Example</strong>: LwM2M requires that at most one Security (/0) object instance
has Bootstrap Server Resource set to 1. If a LwM2M Create operation adds
an instance with this Bootstrap Server = 1 when there already was one, this
handler needs to fail.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">anjay_dm_transaction_commit_t</span></code> - called after the transaction was
successfully validated by the <code class="docutils literal notranslate"><span class="pre">anjay_dm_transaction_validate_t</span></code> handler.
It should atomically apply all changes performed since last call to
<code class="docutils literal notranslate"><span class="pre">anjay_dm_transaction_begin_t</span></code> for the same object.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This handler must not fail, unless a critical and unrecoverable error
(e.g. hardware failure) occurs.</p>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">anjay_dm_transaction_rollback_t</span></code> - called after one of
write/create/remove/validate handlers fails. It should atomically restore
the object to a state it was at the last <code class="docutils literal notranslate"><span class="pre">anjay_dm_transaction_begin_t</span></code>
call.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This handler must not fail, unless a critical and unrecoverable error
(e.g. hardware failure) occurs.</p>
</div>
</li>
</ul>
<p>This tutorial shows an example of implementing transactions by storing
a snapshot of the entire state of an LwM2M Object.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Such implementation, while simple, effectively doubles amount of RAM used
by the Object.</p>
</div>
</div>
</div>
<div class="section" id="transactional-variant">
<span id="fixedinstancewritable-transactional"></span><h2>4.5.4.2. Transactional variant<a class="headerlink" href="#transactional-variant" title="Permalink to this headline">¶</a></h2>
<p>Knowing all about different LwM2M Write variants and Anjay transaction handlers,
we can start implementing a transaction-aware client capable of handling
all LwM2M Write requests.</p>
<p>Let’s start by implementing the <code class="docutils literal notranslate"><span class="pre">instance_reset</span></code> handler. Two boolean flags
need to be added to <code class="docutils literal notranslate"><span class="pre">test_instance_t</span></code> to detect a situation where a value
is considered “unset”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">typedef</span> <span class="n">struct</span> <span class="n">test_instance</span> <span class="p">{</span>
    <span class="nb">bool</span> <span class="n">has_label</span><span class="p">;</span>
    <span class="n">char</span> <span class="n">label</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>

    <span class="nb">bool</span> <span class="n">has_value</span><span class="p">;</span>
    <span class="n">int32_t</span> <span class="n">value</span><span class="p">;</span>
<span class="p">}</span> <span class="n">test_instance_t</span><span class="p">;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">instance_reset</span></code> and <code class="docutils literal notranslate"><span class="pre">resource_write</span></code> should then use these to appropriately
mark Resources as set/unset:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>static int test_instance_reset(anjay_t *anjay,
                               const anjay_dm_object_def_t *const *obj_ptr,
                               anjay_iid_t iid) {
    (void) anjay; // unused

    test_object_t *test = get_test_object(obj_ptr);

    // IID validity was checked by the `anjay_dm_instance_present_t` handler.
    // If the Object Instance set does not change, or can only be modifed
    // via LwM2M Create/Delete requests, it is safe to assume IID is correct.
    assert((size_t) iid &lt; NUM_INSTANCES);

    // mark all Resource values for Object Instance `iid` as unset
    test-&gt;instances[iid].has_label = false;
    test-&gt;instances[iid].has_value = false;
    return 0;
}

// ...

static int test_resource_write(anjay_t *anjay,
                              const anjay_dm_object_def_t *const *obj_ptr,
                              anjay_iid_t iid,
                              anjay_rid_t rid,
                              anjay_input_ctx_t *ctx) {
    // ...

    switch (rid) {
    case 0: {
                // ...

                // value OK - save it
                memcpy(current_instance-&gt;label, buffer, sizeof(buffer));
                current_instance-&gt;has_label = true;

                // ...
        }

    case 1: {
        // reading primitive values can be done directly - the value will only
        // be written to the output variable if everything went fine
        int result = anjay_get_i32(ctx, &amp;current_instance-&gt;value);
        if (result == 0) {
            current_instance-&gt;has_value = true;
        }
        return result;
    }

    // ...
}
</pre></div>
</div>
<p>Having <code class="docutils literal notranslate"><span class="pre">has_label</span></code>/<code class="docutils literal notranslate"><span class="pre">has_value</span></code> flags ready, we can finally implement
transaction handlers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>static int test_transaction_begin(anjay_t *anjay,
                                  const anjay_dm_object_def_t *const *obj_ptr) {
    (void) anjay; // unused

    test_object_t *test = get_test_object(obj_ptr);

    // store a snapshot of object state
    memcpy(test-&gt;backup_instances, test-&gt;instances, sizeof(test-&gt;instances));
    return 0;
}

static int
test_transaction_validate(anjay_t *anjay,
                          const anjay_dm_object_def_t *const *obj_ptr) {
    (void) anjay; // unused

    test_object_t *test = get_test_object(obj_ptr);

    // ensure all Object Instances contain all Mandatory Resources
    for (size_t i = 0; i &lt; NUM_INSTANCES; ++i) {
        if (!test-&gt;instances[i].has_label || !test-&gt;instances[i].has_value) {
            // validation failed: Object state invalid, rollback required
            return ANJAY_ERR_BAD_REQUEST;
        }
    }

    // validation successful, can commit
    return 0;
}

static int
test_transaction_commit(anjay_t *anjay,
                        const anjay_dm_object_def_t *const *obj_ptr) {
    (void) anjay;   // unused
    (void) obj_ptr; // unused

    // no action required in this implementation; if object state snapshot was
    // dynamically allocated, this would be the place for releasing it
    return 0;
}

static int
test_transaction_rollback(anjay_t *anjay,
                          const anjay_dm_object_def_t *const *obj_ptr) {
    (void) anjay; // unused

    test_object_t *test = get_test_object(obj_ptr);

    // restore saved object state
    memcpy(test-&gt;instances, test-&gt;backup_instances, sizeof(test-&gt;instances));
    return 0;
}

// ...

static const anjay_dm_object_def_t OBJECT_DEF = {
    // ...
    .handlers = {
        // ...

        .instance_reset = test_instance_reset,

        // ...

        .transaction_begin = test_transaction_begin,
        .transaction_validate = test_transaction_validate,
        .transaction_commit = test_transaction_commit,
        .transaction_rollback = test_transaction_rollback
    }
};
</pre></div>
</div>
<p>That is everything one needs to set up a complete, transaction-aware writable
Resource.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Complete code of this example can be found in
<cite>examples/tutorial/custom-object/writable-multiple-fixed-transactional</cite>
subdirectory of main Anjay project repository.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="BT_CO5_MultiInstanceDynamic.html" class="btn btn-neutral float-right" title="4.5.5. Multi-instance writable object with dynamic number of instances" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="BT_CO3_MultiInstanceReadOnlyFixed.html" class="btn btn-neutral float-left" title="4.5.3. Multi-instance read-only object with fixed number of instances" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017-2019, AVSystem

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>