<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>9.6. Migrating from Anjay 2.7.x &mdash; Anjay 2.14.1 documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="9.7. Migrating from Anjay 2.8.x" href="MigratingFromAnjay28.html" />
    <link rel="prev" title="9.5. Migrating from Anjay 2.5.x or 2.6.x" href="MigratingFromAnjay26.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #ffd500" >
            <a href="../index.html"><img src="../_static/avsystem_header.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2.14.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../LwM2M.html">2. OMA LwM2M - Brief description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Compiling_client_applications.html">3. Compiling client applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../BasicClient.html">4. Basic client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AdvancedTopics.html">5. Advanced topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FirmwareUpdateTutorial.html">6. Firmware Update Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tools.html">7. Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PortingGuideForNonPOSIXPlatforms.html">8. Porting guide for non-POSIX platforms</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../Migrating.html">9. Migrating from older versions</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="MigratingFromAnjay116.html">9.1. Migrating from Anjay 1.16</a></li>
<li class="toctree-l2"><a class="reference internal" href="MigratingFromAnjay225.html">9.2. Migrating from Anjay 2.2.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="MigratingCustomEntropy.html">9.3. Migrating mbed TLS custom entropy initializers</a></li>
<li class="toctree-l2"><a class="reference internal" href="MigratingFromAnjay24.html">9.4. Migrating from Anjay 2.3.x or 2.4.x</a></li>
<li class="toctree-l2"><a class="reference internal" href="MigratingFromAnjay26.html">9.5. Migrating from Anjay 2.5.x or 2.6.x</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">9.6. Migrating from Anjay 2.7.x</a></li>
<li class="toctree-l2"><a class="reference internal" href="MigratingFromAnjay28.html">9.7. Migrating from Anjay 2.8.x</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Commercial_support.html">10. Commercial support</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #ffd500" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Anjay</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../Migrating.html"><span class="section-number">9. </span>Migrating from older versions</a> &raquo;</li>
      <li><span class="section-number">9.6. </span>Migrating from Anjay 2.7.x</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="migrating-from-anjay-2-7-x">
<h1><span class="section-number">9.6. </span>Migrating from Anjay 2.7.x<a class="headerlink" href="#migrating-from-anjay-2-7-x" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id1">Introduction</a></p></li>
<li><p><a class="reference internal" href="#change-to-minimum-cmake-version" id="id2">Change to minimum CMake version</a></p></li>
<li><p><a class="reference internal" href="#separation-of-avs-url-module" id="id3">Separation of avs_url module</a></p></li>
<li><p><a class="reference internal" href="#refactor-of-avs-net-validate-ip-address-and-avs-net-local-address-for-target-host" id="id4">Refactor of avs_net_validate_ip_address() and avs_net_local_address_for_target_host()</a></p></li>
<li><p><a class="reference internal" href="#reorganization-of-hsm-support" id="id5">Reorganization of HSM support</a></p></li>
</ul>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id1"><span class="section-number">9.6.1. </span>Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>While most changes since Anjay 2.7 are minor, the advancements in HSM
integration in <code class="docutils literal notranslate"><span class="pre">avs_commons</span></code> required some breaking changes in they way
compile-time configuration of that library is performed.</p>
<p><strong>No manual changes</strong> (aside from possibly upgrading CMake) <strong>should be
necessary if you are using CMake to compile your project and using the default
POSIX socket integration.</strong> If you are using any alternative build system, you
might need to make adjustments to your configuration headers. If you maintain
your own socket integration, you might need to make slight adjustments to your
code.</p>
</div>
<div class="section" id="change-to-minimum-cmake-version">
<h2><a class="toc-backref" href="#id2"><span class="section-number">9.6.2. </span>Change to minimum CMake version</a><a class="headerlink" href="#change-to-minimum-cmake-version" title="Permalink to this headline">¶</a></h2>
<p>Declared minimum CMake version necessary for CMake-based compilation, as well as
for importing the installed library through <code class="docutils literal notranslate"><span class="pre">find_package()</span></code>, is now 3.6. If
you’re using some Linux distribution that only has an older version in its
repositories (notably, Ubuntu 16.04), we recommend using one of the following
install methods instead:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://apt.kitware.com/">Kitware APT Repository for Debian and Ubuntu</a></p></li>
<li><p><a class="reference external" href="https://snapcraft.io/cmake">Snap Store</a> (<code class="docutils literal notranslate"><span class="pre">snap</span> <span class="pre">install</span> <span class="pre">cmake</span></code>)</p></li>
<li><p><a class="reference external" href="https://pypi.org/project/cmake/">Python Package Index</a>
(<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">cmake</span></code>)</p></li>
</ul>
<p>This change does not affect users who compile the library using some alternative
approach, without using the provided CMake scripts.</p>
</div>
<div class="section" id="separation-of-avs-url-module">
<h2><a class="toc-backref" href="#id3"><span class="section-number">9.6.3. </span>Separation of avs_url module</a><a class="headerlink" href="#separation-of-avs-url-module" title="Permalink to this headline">¶</a></h2>
<p>URL handling routines, previously a part of <code class="docutils literal notranslate"><span class="pre">avs_net</span></code>, are now a separate
component of <code class="docutils literal notranslate"><span class="pre">avs_commons</span></code>. The specific consequences of that may vary
depending on your build process, e.g.:</p>
<ul class="simple">
<li><p>You will need to add <code class="docutils literal notranslate"><span class="pre">#define</span> <span class="pre">AVS_COMMONS_WITH_AVS_URL</span></code> to your
<code class="docutils literal notranslate"><span class="pre">avs_commons_config.h</span></code> if you specify it manually</p></li>
<li><p>You may need to add <code class="docutils literal notranslate"><span class="pre">-lavs_url</span></code> to your link command if you’re using
<code class="docutils literal notranslate"><span class="pre">avs_commons</span></code> that has been manually compiled separately using CMake</p></li>
</ul>
</div>
<div class="section" id="refactor-of-avs-net-validate-ip-address-and-avs-net-local-address-for-target-host">
<h2><a class="toc-backref" href="#id4"><span class="section-number">9.6.4. </span>Refactor of avs_net_validate_ip_address() and avs_net_local_address_for_target_host()</a><a class="headerlink" href="#refactor-of-avs-net-validate-ip-address-and-avs-net-local-address-for-target-host" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">avs_net_validate_ip_address()</span></code> is now no longer used by Anjay or
<code class="docutils literal notranslate"><span class="pre">avs_commons</span></code>. It was previously necessary to implement it as part of the
socket implementation. This is no longer required. For compatibility, the
function has been reimplemented as a <code class="docutils literal notranslate"><span class="pre">static</span> <span class="pre">inline</span></code> function that wraps
<code class="docutils literal notranslate"><span class="pre">avs_net_addrinfo_*()</span></code> APIs. Please remove your version of
<code class="docutils literal notranslate"><span class="pre">avs_net_validate_ip_address()</span></code> from your socket implementation if you have
one, as having two alternative variants may lead to conflicts.</p>
<p>Since Anjay 2.9 and <code class="docutils literal notranslate"><span class="pre">avs_commons</span></code> 4.6,
<code class="docutils literal notranslate"><span class="pre">avs_net_local_address_for_target_host()</span></code> underwent a similar refactor. It was
previously a function to be optionally implemented as part of the socket
implementation, but now it is a <code class="docutils literal notranslate"><span class="pre">static</span> <span class="pre">inline</span></code> function that wraps
<code class="docutils literal notranslate"><span class="pre">avs_net_socket_*()</span></code> APIs. Please remove your version of
<code class="docutils literal notranslate"><span class="pre">avs_net_local_address_for_target_host()</span></code> from your socket implementation if
you have one, as having two alternative variants may lead to conflicts.</p>
</div>
<div class="section" id="reorganization-of-hsm-support">
<h2><a class="toc-backref" href="#id5"><span class="section-number">9.6.5. </span>Reorganization of HSM support</a><a class="headerlink" href="#reorganization-of-hsm-support" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Low-level HSM support is available in open-source <code class="docutils literal notranslate"><span class="pre">avs_commons</span></code>, but
integration of these features with Anjay is only available in the commercial
version.</p>
</div>
<p>Coupling of the Hardware Security Module support in <code class="docutils literal notranslate"><span class="pre">avs_commons</span></code> has been
loosened, making it possible to replace the reference implementation based on
<code class="docutils literal notranslate"><span class="pre">libp11</span></code> with a custom one.</p>
<ul class="simple">
<li><p>New CMake configuration flag <code class="docutils literal notranslate"><span class="pre">WITH_AVS_CRYPTO_ENGINE</span></code>, and its corresponding
configuration header macro <code class="docutils literal notranslate"><span class="pre">AVS_COMMONS_WITH_AVS_CRYPTO_ENGINE</span></code> have been
added.</p></li>
<li><p>Enabling the aforementioned flag is now a dependency for enabling
<code class="docutils literal notranslate"><span class="pre">WITH_OPENSSL_PKCS11_ENGINE</span></code> (CMake) /
<code class="docutils literal notranslate"><span class="pre">AVS_COMMONS_WITH_OPENSSL_PKCS11_ENGINE</span></code> (header)</p></li>
</ul>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="MigratingFromAnjay26.html" class="btn btn-neutral float-left" title="9.5. Migrating from Anjay 2.5.x or 2.6.x" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="MigratingFromAnjay28.html" class="btn btn-neutral float-right" title="9.7. Migrating from Anjay 2.8.x" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017-2021, AVSystem.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>