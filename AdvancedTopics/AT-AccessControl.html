<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>5.1. Access Control in multi-server environment &mdash; Anjay 3.3.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5.2. Attribute storage" href="AT-AttributeStorage.html" />
    <link rel="prev" title="5. Advanced topics" href="../AdvancedTopics.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #ffd500" >
            <a href="../index.html">
            <img src="../_static/avsystem_header.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                3.3.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../LwM2M.html">2. OMA LwM2M - Brief description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Compiling_client_applications.html">3. Compiling client applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../BasicClient.html">4. Basic client</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../AdvancedTopics.html">5. Advanced topics</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">5.1. Access Control in multi-server environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="AT-AttributeStorage.html">5.2. Attribute storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="AT-Certificates.html">5.3. DTLS connection using certificates</a></li>
<li class="toctree-l2"><a class="reference internal" href="AT-CustomObjects.html">5.4. Custom LwM2M objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="AT-NetworkErrorHandling.html">5.5. Network error handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="AT-OtherFeatures.html">5.6. Other library features</a></li>
<li class="toctree-l2"><a class="reference internal" href="AT-Persistence.html">5.7. Persistence support</a></li>
<li class="toctree-l2"><a class="reference internal" href="AT-RetransmissionsTimeoutsCaching.html">5.8. Retransmissions, timeouts &amp; response caching</a></li>
<li class="toctree-l2"><a class="reference internal" href="AT-CustomEventLoop.html">5.9. Custom event loop</a></li>
<li class="toctree-l2"><a class="reference internal" href="AT-EventLoopNotes.html">5.10. Notes on event loop APIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="AT-IpsoObjects.html">5.11. Anjay IPSO Objects implementation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../FirmwareUpdateTutorial.html">6. Firmware Update Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tools.html">7. Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PortingGuideForNonPOSIXPlatforms.html">8. Porting guide for non-POSIX platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Migrating.html">9. Migrating from older versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CommercialFeatures.html">10. Commercial features</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #ffd500" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Anjay</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../AdvancedTopics.html"><span class="section-number">5. </span>Advanced topics</a> &raquo;</li>
      <li><span class="section-number">5.1. </span>Access Control in multi-server environment</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="access-control-in-multi-server-environment">
<h1><span class="section-number">5.1. </span>Access Control in multi-server environment<a class="headerlink" href="#access-control-in-multi-server-environment" title="Permalink to this heading"></a></h1>
<p>LwM2M Client may be connected to more than one LwM2M Server. In such situation,
restricting Server access to some part of the <a class="reference internal" href="../LwM2M.html#data-model"><span class="std std-ref">data model</span></a>
may be required.</p>
<p>To resolve this problem the LwM2M Specification defines an Access Control
Object that allows setting specific access rights on data model Instances
either during a Bootstrap Phase or normal runtime by properly authorized
LwM2M Server.</p>
<p>In a multi-server environment every Object Instance (except Instances of
the Access Control Object) has associated Access Control Instance:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 27%" />
<col style="width: 16%" />
<col style="width: 58%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Resource</p></th>
<th class="head"><p>Resource ID</p></th>
<th class="head"><p>Meaning of the value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Object ID</p></td>
<td><p>0</p></td>
<td><p>ID of the Object this instance targets</p></td>
</tr>
<tr class="row-odd"><td><p>Object Instance ID</p></td>
<td><p>1</p></td>
<td><p>Object Instance ID this instance targets
(also see the note below)</p></td>
</tr>
<tr class="row-even"><td><p>ACL</p></td>
<td><p>2</p></td>
<td><p>List of pairs (<cite>Short Server ID</cite>,
<cite>Access mask</cite>) describing access rights
assigned to LwM2M Servers</p></td>
</tr>
<tr class="row-odd"><td><p>Access Control Owner</p></td>
<td><p>3</p></td>
<td><p>Short Server ID of the Server which owns
this Access Control Instance (i.e. the
one that can modify access rights)</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">65535</span></code> is a special <cite>Object Instance ID</cite> value reserved for use during
the Bootstrap Phase and is valid only in combination with <strong>Create</strong>
access flag.</p>
</div>
<section id="acl-resource">
<h2><span class="section-number">5.1.1. </span>ACL Resource<a class="headerlink" href="#acl-resource" title="Permalink to this heading"></a></h2>
<p>ACL Resource of the Access Control Object Instance is populated with pairs
of form (<cite>Short Server ID</cite>, <cite>Access mask</cite>). Access mask is a combination of
the following access flags (combined by bitwise OR operator):</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 33%" />
<col style="width: 39%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Access flag</p></th>
<th class="head"><p>Allowed LwM2M Operations</p></th>
<th class="head"><p>Anjay representation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">R</span></code> (00001 binary)</p></td>
<td><p>Read, Observe</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ANJAY_ACCESS_MASK_READ</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">W</span></code> (00010 binary)</p></td>
<td><p>Write</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ANJAY_ACCESS_MASK_WRITE</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">E</span></code> (00100 binary)</p></td>
<td><p>Execute</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ANJAY_ACCESS_MASK_EXECUTE</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">D</span></code> (01000 binary)</p></td>
<td><p>Delete</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ANJAY_ACCESS_MASK_DELETE</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">C</span></code> (10000 binary)</p></td>
<td><p>Create</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ANJAY_ACCESS_MASK_CREATE</span></code></p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Discover operation is <strong>always</strong> allowed and LwM2M protocol does not provide
a mechanism for forbidding it.</p>
</div>
</section>
<section id="note-on-data-model-instances-lifetime">
<h2><span class="section-number">5.1.2. </span>Note on data-model instances lifetime<a class="headerlink" href="#note-on-data-model-instances-lifetime" title="Permalink to this heading"></a></h2>
<p>Access Control Object also helps in managing Object Instance lifetime. Whenever
some Object Instance is orphaned (i.e. no LwM2M Server is an Access Control
Owner of the Access Control Instance associated with this Object Instance) it
MUST be removed by the Client. Anjay’s pre-implemented Access Control Object
does this automatically.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Of course, if necessary, you may implement your own Access Control
Object and use it instead. Nonetheless it is worth noting that it
is an extremely complex Object to implement in a correct way.</p>
</div>
</section>
<section id="example-usage">
<h2><span class="section-number">5.1.3. </span>Example usage<a class="headerlink" href="#example-usage" title="Permalink to this heading"></a></h2>
<p>In this example, we are going to setup multiple-server
environment. We will assign LwM2M Server with SSID 1 the <strong>Create</strong>
permission on the <a class="reference internal" href="AT-CustomObjects/AT_CO_MultiInstanceDynamic.html"><span class="doc">Test Object developed in another tutorial</span></a>.</p>
<p>Additionally, we will allow both LwM2M Servers to read their respective LwM2M
Server Instances.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>What we do here is roughly equivalent to <strong>Factory Bootstrap</strong> phase,
which is just one of the bootstrapping options. Same thing could be
achieved by a Bootstrap Server, which in conformance with the LwM2M
Specification would instantiate Access Control Object, and assign access
permissions on its own in a multiple-server environment.</p>
</div>
<p>We start with installation of the Access Control, Security Object and Server
Object modules:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">anjay_access_control_install</span><span class="p">(</span><span class="n">anjay</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="o">||</span><span class="w"> </span><span class="n">anjay_security_object_install</span><span class="p">(</span><span class="n">anjay</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="o">||</span><span class="w"> </span><span class="n">anjay_server_object_install</span><span class="p">(</span><span class="n">anjay</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Then we setup two LwM2M Servers:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">// LwM2M Server account with SSID = 1</span>
<span class="k">const</span><span class="w"> </span><span class="n">anjay_security_instance_t</span><span class="w"> </span><span class="n">security_instance1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">ssid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">server_uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;coap://eu.iot.avsystem.cloud:5683&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">security_mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ANJAY_SECURITY_NOSEC</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">const</span><span class="w"> </span><span class="n">anjay_server_instance_t</span><span class="w"> </span><span class="n">server_instance1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">ssid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">lifetime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">86400</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">default_min_period</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">default_max_period</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">disable_timeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">binding</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;U&quot;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="c1">// LwM2M Server account with SSID = 2</span>
<span class="k">const</span><span class="w"> </span><span class="n">anjay_security_instance_t</span><span class="w"> </span><span class="n">security_instance2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">ssid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">server_uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;coap://127.0.0.1:5683&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">security_mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ANJAY_SECURITY_NOSEC</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">const</span><span class="w"> </span><span class="n">anjay_server_instance_t</span><span class="w"> </span><span class="n">server_instance2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">ssid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">lifetime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">86400</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">default_min_period</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">default_max_period</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">disable_timeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">binding</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;U&quot;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="c1">// Setup first LwM2M Server</span>
<span class="n">anjay_iid_t</span><span class="w"> </span><span class="n">server_instance_iid1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ANJAY_ID_INVALID</span><span class="p">;</span><span class="w"></span>
<span class="n">anjay_security_object_add_instance</span><span class="p">(</span><span class="n">anjay</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">security_instance1</span><span class="p">,</span><span class="w"></span>
<span class="w">                                   </span><span class="o">&amp;</span><span class="p">(</span><span class="n">anjay_iid_t</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">ANJAY_ID_INVALID</span><span class="w"> </span><span class="p">});</span><span class="w"></span>
<span class="n">anjay_server_object_add_instance</span><span class="p">(</span><span class="n">anjay</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">server_instance1</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="o">&amp;</span><span class="n">server_instance_iid1</span><span class="p">);</span><span class="w"></span>

<span class="c1">// Setup second LwM2M Server</span>
<span class="n">anjay_iid_t</span><span class="w"> </span><span class="n">server_instance_iid2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ANJAY_ID_INVALID</span><span class="p">;</span><span class="w"></span>
<span class="n">anjay_security_object_add_instance</span><span class="p">(</span><span class="n">anjay</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">security_instance2</span><span class="p">,</span><span class="w"></span>
<span class="w">                                   </span><span class="o">&amp;</span><span class="p">(</span><span class="n">anjay_iid_t</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">ANJAY_ID_INVALID</span><span class="w"> </span><span class="p">});</span><span class="w"></span>
<span class="n">anjay_server_object_add_instance</span><span class="p">(</span><span class="n">anjay</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">server_instance2</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="o">&amp;</span><span class="n">server_instance_iid2</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>And finally, we are ready to set access lists:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">// Make SSID = 1 the owner of the Test object</span>
<span class="n">anjay_access_control_set_owner</span><span class="p">(</span><span class="n">anjay</span><span class="p">,</span><span class="w"> </span><span class="mi">1234</span><span class="p">,</span><span class="w"> </span><span class="n">ANJAY_ID_INVALID</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="n">server_instance1</span><span class="p">.</span><span class="n">ssid</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><span class="w"></span>

<span class="c1">// Set LwM2M Create permission rights for it as well</span>
<span class="n">anjay_access_control_set_acl</span><span class="p">(</span><span class="n">anjay</span><span class="p">,</span><span class="w"> </span><span class="mi">1234</span><span class="p">,</span><span class="w"> </span><span class="n">ANJAY_ID_INVALID</span><span class="p">,</span><span class="w"></span>
<span class="w">                             </span><span class="n">server_instance1</span><span class="p">.</span><span class="n">ssid</span><span class="p">,</span><span class="w"></span>
<span class="w">                             </span><span class="n">ANJAY_ACCESS_MASK_CREATE</span><span class="p">);</span><span class="w"></span>

<span class="c1">// Allow both LwM2M Servers to read their Server Instances</span>
<span class="n">anjay_access_control_set_acl</span><span class="p">(</span><span class="n">anjay</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">server_instance_iid1</span><span class="p">,</span><span class="w"></span>
<span class="w">                             </span><span class="n">server_instance1</span><span class="p">.</span><span class="n">ssid</span><span class="p">,</span><span class="w"> </span><span class="n">ANJAY_ACCESS_MASK_READ</span><span class="p">);</span><span class="w"></span>
<span class="n">anjay_access_control_set_acl</span><span class="p">(</span><span class="n">anjay</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">server_instance_iid2</span><span class="p">,</span><span class="w"></span>
<span class="w">                             </span><span class="n">server_instance2</span><span class="p">.</span><span class="n">ssid</span><span class="p">,</span><span class="w"> </span><span class="n">ANJAY_ACCESS_MASK_READ</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>That way we have ensured an exclusive access of Server with SSID 1 to Test
Object (<code class="docutils literal notranslate"><span class="pre">/1234</span></code>) Instances.</p>
<p>Later on, this Server will be able to set some access rights for other Servers,
by writing to proper Access Control Instances (i.e. Instances this Server
is an owner of, which corresponds to instances it has created), but that’s
outside of the scope of this tutorial. We recommend you to look at the LwM2M
Specification for more details on Access Control Object, as well as at our
<a class="reference external" href="../api/index.html">API docs</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please notice <code class="docutils literal notranslate"><span class="pre">cleanup</span></code> tag at end of <code class="docutils literal notranslate"><span class="pre">main()</span></code> function. It is important
to delete your own implemented objects after calling <code class="docutils literal notranslate"><span class="pre">anjay_delete()</span></code>, as
during the instance destruction Anjay may still try to refer to object’s
data and premature object deletion could be disastrous in effects.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="nl">cleanup</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="n">anjay_delete</span><span class="p">(</span><span class="n">anjay</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">delete_test_object</span><span class="p">(</span><span class="n">test_obj</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../AdvancedTopics.html" class="btn btn-neutral float-left" title="5. Advanced topics" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="AT-AttributeStorage.html" class="btn btn-neutral float-right" title="5.2. Attribute storage" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017-2023, AVSystem.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>